/* ===== Reset básico ===== */

html,
body {
    height: 100%;
    width: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    /* sem scroll do body */
}

body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

#app {
    height: 100vh;
    width: 100%;
}

/* ===== Override layout padrão do Blazor para este app ===== */
.content {
    padding: 0 !important;
    margin: 0 !important;
}


/* ===== Layout geral do Spider ===== */

.spider-root {
    width: 100%;
    height: 100vh;
    background: #0b5a35;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    padding: 8px;

    /* cartas um pouco maiores por defeito */
    --card-width: min(8vw, 86px);
    --card-height: calc(var(--card-width) * 1.4);
    --card-offset-down: calc(var(--card-height) * 0.20);
    --card-offset-up: calc(var(--card-height) * 0.35);
}


/* barra de topo */

.spider-top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 16px 4px 16px;
    color: #f5f5f5;
}

.spider-title {
    font-size: 1.5rem;
    font-weight: 600;
}

.spider-info {
    font-size: 0.9rem;
    opacity: 0.9;
}

/* linha de controlos + baralho */

.spider-controls-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 4px 16px 0 16px;
    color: #f5f5f5;
    font-size: 0.9rem;
}

.spider-controls-left {
    flex: 1;
    align-items: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.spider-controls-center {
    flex: 2;
    text-align: center;
}

.spider-controls-center select {
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid #ffffff;
    background: #0b5a35;
    color: #ffffff;
}

.suit-level-label {
    margin-right: 6px;
}

.spider-controls-right {
    flex: 1;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 12px;
}

.spider-controls-row button {
    padding: 4px 4px;
    border-radius: 6px;
    border: 1px solid #ffffff;
    background: transparent;
    color: #ffffff;
    cursor: pointer;
    align-self: self-start;
}

/* status */

.spider-status {
    padding: 2px 16px 4px 16px;
    font-size: 0.85rem;
    color: #f5f5f5;
    opacity: 0.9;
}

/* área do tableau */

.spider-tableau-wrapper {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 8px;
    box-sizing: border-box;
    overflow-x: hidden;
    /* scroll horizontal no mobile */
}

.spider-tableau {
    display: grid;
    grid-template-columns: repeat(10, var(--card-width));
    column-gap: calc(var(--card-width) * 0.35);
    justify-content: center;
    align-content: flex-start;
    padding: 6px 18px 18px;
    width: max-content;
    min-width: 100%;
}

/* coluna */

.spider-pile {
    width: var(--card-width);
    min-height: calc(var(--card-height) + var(--card-offset-up) * 20);
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

/* ===== Cartas ===== */

.card-slot {
    width: var(--card-width);
    height: calc(var(--card-height) * var(--card-scale, 1));
    border-radius: 5px;
    box-sizing: border-box;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
    position: absolute;

    /* stack-pos = múltiplo da altura da carta */
    top: calc(var(--stack-pos, 0) * var(--card-height) * var(--pile-compress, 1));

    left: 0;
    z-index: var(--card-index, 0);
    pointer-events: auto;
    overflow: hidden;
}

/* carta do topo (altura normal) */
.card-slot.card-top {
    height: calc(var(--card-height) * var(--card-scale, 1));
}

/* cartas inferiores com a mesma altura; a sobreposição é controlada pelo top */
.card-slot.card-stacked {
    height: calc(var(--card-height) * var(--card-scale, 1));
}

/* frente da carta */

.card-slot.face-up {
    background-color: #ffffff;
    border: 2px solid #000000;
    background-image: var(--card-face);
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
}

/* costas da carta – altura mais baixa */
.card-slot.face-down {
    --card-scale: 0.25;
    /* faixa baixa para mostrar várias */
    background-color: #003a77;
    border: 2px solid #f5f5f5;
    background-image:
        linear-gradient(45deg,
            rgba(255, 255, 255, 0.5) 25%,
            transparent 25%,
            transparent 50%,
            rgba(255, 255, 255, 0.5) 50%,
            rgba(255, 255, 255, 0.5) 75%,
            transparent 75%,
            transparent);
    background-size: 8px 8px;
}

/* coluna vazia */

.card-slot.empty {
    background: transparent;
    border: 2px dashed rgba(255, 255, 255, 0.7);
    box-shadow: none;
    top: 0;
    left: 0;
}

/* carta selecionada */

.card-slot.selected {
    outline: 3px solid yellow;
    outline-offset: 2px;
}

/* cartas que NÃO pertencem à sequência movível */
.card-slot.disabled-move {
    opacity: 0.35;
    filter: grayscale(100%);
    cursor: not-allowed;
}

/* conteúdo interno da carta virada para cima */

.card-face {
    display: none;
}

/* cantos (número + naipe) */

.card-corner {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-size: calc(var(--card-width) * 0.35);
    font-weight: bold;
}

.card-corner .suit {
    font-size: calc(var(--card-width) * 0.2);
}

.card-corner-top {
    top: 4px;
    left: 4px;
}

.card-corner-bottom {
    bottom: 4px;
    right: 4px;
    transform: rotate(180deg);
}

/* símbolo central */

.card-pips {
    font-size: calc(var(--card-width) * 0.8);
}

/* ===== Baralho / stock ===== */

.stock-area {
    /* NÃO definir width aqui, deixa o conteúdo ditar a largura */
    height: var(--card-height);
    border-radius: 5px;
    box-sizing: border-box;
    cursor: pointer;
    display: flex;
    align-items: center;
}

.stock-stack {
    display: flex;
    align-items: center;
}

.stock-card {
    width: calc(var(--card-width) * 0.6);
    height: calc(var(--card-width) * 1);
    border-radius: 5px;
    box-sizing: border-box;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}



.stock-stack .stock-card.back:first-child {
    margin-left: 0;
}

.stock-card.back {
    background-color: #003a77;
    border: 2px solid #f5f5f5;
    background-image:
        linear-gradient(45deg,
            rgba(255, 255, 255, 0.5) 25%,
            transparent 25%,
            transparent 50%,
            rgba(255, 255, 255, 0.5) 50%,
            rgba(255, 255, 255, 0.5) 75%,
            transparent 75%,
            transparent);
    background-size: 8px 8px;
}

.stock-card.empty {
    width: var(--card-width);
    height: var(--card-height);
    border-radius: 5px;
    box-sizing: border-box;
    background: transparent;
    border: 2px dashed rgba(255, 255, 255, 0.7);
    box-shadow: none;
}


/* ===== Sequências completas (foundation) ===== */

.completed-area {
    display: flex;
    align-items: center;
}

.completed-card {
    width: calc(var(--card-width) * 0.6);
    height: calc(var(--card-height) * 0.6);
    border-radius: 6px;
    box-sizing: border-box;
    margin-left: -10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

.completed-card:first-child {
    margin-left: 0;
}

.completed-card.back {
    background-color: #003a77;
    border: 2px solid #f5f5f5;
    background-image:
        linear-gradient(45deg,
            rgba(255, 255, 255, 0.5) 25%,
            transparent 25%,
            transparent 50%,
            rgba(255, 255, 255, 0.5) 50%,
            rgba(255, 255, 255, 0.5) 75%,
            transparent 75%,
            transparent);
    background-size: 8px 8px;
}

.completed-area,
.stock-area {
    flex-shrink: 0;
    /* não encolher quando o espaço é apertado */
}

/* ===== Overlay de fim de jogo / vitória ===== */

.spider-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.spider-overlay-content {
    position: relative;
    background: #15212b;
    border-radius: 14px;
    padding: 24px 32px;
    min-width: 260px;
    max-width: 340px;
    text-align: center;
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.7);
    color: #f5f5f5;
}

.spider-overlay-emoji {
    font-size: 3rem;
    margin-bottom: 8px;
}

/* --- Vitória --- */

.spider-overlay-win .spider-overlay-content {
    background: radial-gradient(circle at top, #2ecc71 0%, #0b4125 40%, #111 100%);
    border: 2px solid #2ecc71;
}

.spider-overlay-win h2 {
    margin: 0 0 6px;
    font-size: 1.9rem;
}

.spider-overlay-win p {
    margin: 0 0 18px;
    font-size: 0.95rem;
    opacity: 0.95;
}

.spider-overlay-win button {
    padding: 6px 20px;
    border-radius: 999px;
    border: 1px solid #ffffff;
    background: #2ecc71;
    color: #ffffff;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.95rem;
    transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.15s ease;
}

.spider-overlay-win button:hover {
    background: #27ae60;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    transform: translateY(-1px);
}

.spider-overlay-win button:active {
    transform: translateY(0);
    box-shadow: none;
}

/* Confetti */

.spider-confetti {
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
    z-index: -1;
    /* atrás da caixa */
}

.confetti-piece {
    position: absolute;
    width: 8px;
    height: 14px;
    background: #f1c40f;
    top: -20px;
    left: 50%;
    opacity: 0;
    animation: confetti-fall 2.4s linear infinite;
}

.confetti-piece:nth-child(odd) {
    background: #e74c3c;
}

.confetti-piece:nth-child(3n) {
    background: #3498db;
}

.confetti-piece:nth-child(4n) {
    background: #9b59b6;
}

@keyframes confetti-fall {
    0% {
        transform: translate3d(0, -40px, 0) rotateZ(0deg);
        opacity: 0;
    }

    10% {
        opacity: 1;
    }

    100% {
        transform: translate3d(var(--confetti-x, 0), 260px, 0) rotateZ(360deg);
        opacity: 0;
    }
}

/* espalhar horizontalmente algumas peças */
.confetti-piece:nth-child(1) {
    --confetti-x: -60px;
    animation-delay: 0s;
}

.confetti-piece:nth-child(2) {
    --confetti-x: 40px;
    animation-delay: 0.1s;
}

.confetti-piece:nth-child(3) {
    --confetti-x: -10px;
    animation-delay: 0.2s;
}

.confetti-piece:nth-child(4) {
    --confetti-x: 80px;
    animation-delay: 0.3s;
}

.confetti-piece:nth-child(5) {
    --confetti-x: -90px;
    animation-delay: 0.4s;
}

.confetti-piece:nth-child(6) {
    --confetti-x: 20px;
    animation-delay: 0.5s;
}

.confetti-piece:nth-child(7) {
    --confetti-x: -40px;
    animation-delay: 0.6s;
}

.confetti-piece:nth-child(8) {
    --confetti-x: 60px;
    animation-delay: 0.7s;
}

.confetti-piece:nth-child(9) {
    --confetti-x: -70px;
    animation-delay: 0.8s;
}

.confetti-piece:nth-child(10) {
    --confetti-x: 10px;
    animation-delay: 0.9s;
}

.confetti-piece:nth-child(11) {
    --confetti-x: -120px;
    animation-delay: 1s;
}

.confetti-piece:nth-child(12) {
    --confetti-x: 100px;
    animation-delay: 1.1s;
}

.confetti-piece:nth-child(13) {
    --confetti-x: -30px;
    animation-delay: 1.2s;
}

.confetti-piece:nth-child(14) {
    --confetti-x: 70px;
    animation-delay: 1.3s;
}

.confetti-piece:nth-child(15) {
    --confetti-x: -50px;
    animation-delay: 1.4s;
}

.confetti-piece:nth-child(16) {
    --confetti-x: 110px;
    animation-delay: 1.5s;
}

.confetti-piece:nth-child(17) {
    --confetti-x: -80px;
    animation-delay: 1.6s;
}

.confetti-piece:nth-child(18) {
    --confetti-x: 30px;
    animation-delay: 1.7s;
}

.confetti-piece:nth-child(19) {
    --confetti-x: -100px;
    animation-delay: 1.8s;
}

.confetti-piece:nth-child(20) {
    --confetti-x: 90px;
    animation-delay: 1.9s;
}

/* --- Derrota --- */

.spider-overlay-lose .spider-overlay-content {
    border: 2px solid #e74c3c;
    background: #15212b;
}

.spider-overlay-lose h2 {
    margin: 0 0 6px;
    font-size: 1.8rem;
}

.spider-overlay-lose p {
    margin: 0 0 18px;
    font-size: 0.95rem;
    opacity: 0.9;
}

.spider-overlay-lose button {
    padding: 6px 20px;
    border-radius: 999px;
    border: 1px solid #ffffff;
    background: #e74c3c;
    color: #ffffff;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.95rem;
    transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.15s ease;
}

.spider-overlay-lose button:hover {
    background: #c0392b;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    transform: translateY(-1px);
}

.spider-overlay-lose button:active {
    transform: translateY(0);
    box-shadow: none;
}

/* ===== Responsividade (mobile/tablet) ===== */

@media (max-width: 640px) {
    .spider-root {
        padding: 0;
        /* calcular a largura da carta para caberem 10 colunas no ecrã */
        --card-width: calc((100vw - 16px) / 9.7);
        --card-height: calc(var(--card-width) * 1.7);
        --card-offset-down: calc(var(--card-height) * 0.28);
        --card-offset-up: calc(var(--card-height) * 0.40);
    }

    .spider-controls-row {
        flex-direction: row;
        gap: 6px;
        padding: 4px 8px 0;
    }

    .spider-tableau-wrapper {
        padding: 8px 4px 12px 4px;
        overflow-x: hidden;
        /* já cabem as 10 colunas, não precisamos de scroll */
    }

    .spider-tableau {
        padding: 0;
        column-gap: 0.8px;
        /* quase sem espaço entre colunas para caber tudo */
        justify-content: center;
    }

    /* stock + sequências mais pequenos no topo (mobile) */
    .completed-card {
        width: calc(var(--card-width) * 0.5);
        height: calc(var(--card-height) * 0.5);
    }

    .stock-stack .stock-card.back {
        width: calc(var(--card-width) * 0.5);
        height: calc(var(--card-height) * 0.5);
        margin-left: -6px;
    }

    .stock-card.empty {
        width: calc(var(--card-width) * 0.5);
        height: calc(var(--card-height) * 0.5);
    }

    .card-slot {
        width: calc(var(--card-width) * 0.9);
        height: calc(var(--card-height) * 1);
    }

    .spider-pile {
        margin-left: 2px;
    }

    .card-slot.face-up {
        height: calc(var(--card-height) * 0.75);
         width: calc(var(--card-width) * 0.9);
    }

    .spider-controls-right {
        flex-direction: column;
        align-items: flex-end;
    }
}


@media (min-width: 641px) and (max-width: 1024px) {

    .spider-root {
        padding: 12px 16px;
        /* cartas mais largas em tablets / landscape phones grandes */
        --card-width: clamp(54px, calc((100% - 80px) / 10.5), 78px);
        --card-height: calc(var(--card-width) * 1.4);
        --card-offset-down: calc(var(--card-height) * 0.24);
        --card-offset-up: calc(var(--card-height) * 0.36);
    }

    .spider-tableau-wrapper {
        padding-left: 4vw;
        padding-right: 4vw;
    }

    .spider-tableau {
        column-gap: calc(var(--card-width) * 0.3);
    }

    .stock-area {
        align-items: right;
    }
}


@media (min-width: 641px) and (max-width: 1024px) and (orientation: landscape) {
    .spider-root {
        --card-width: clamp(34px, calc((100% - 72px) / 12), 64px);
        --card-height: calc(var(--card-width) * 1.4);
        --card-offset-down: calc(var(--card-height) * 0.26);
        --card-offset-up: calc(var(--card-height) * 0.285);
    }

    .spider-tableau-wrapper {
        padding-left: 6vw;
        padding-right: 6vw;
    }
}

/* impedir zoom automático do iOS em botões / selects / etc. */
button,
select,
.spider-controls-row,
.spider-controls-row * {
    font-size: 16px !important;
}
